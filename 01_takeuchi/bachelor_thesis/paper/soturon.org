* 卒論
** 要旨

** 目次
   - 序論
   - 車両装備仕様問題
   - 解集合プログラミング
   - 車両装備仕様問題のASP符号化
   - 性能評価
   - 結論
   - 参考文献

** 序論
   車両のモデルやグレードを考案する際，企業は装備同士の依存関係や，燃費に関する制約を満たしながら
   販売台数を最大化したいと考える．
   これは，組合せ最適化問題の一種であり，．
   企業別平均燃費基準は...
   アメリカやEUではすでに採用されており，日本でも2020年度燃費基準...
** 車両装備仕様問題
   - 車両装備仕様問題
     本節では，車両装備仕様問題について説明する．
     車両装備仕様とは，自動車のカタログに記載されている自動車のモデル，グレードとの組み合わせのことである
     車両装備仕様問題とは．組合せ最適化問題の一種である．

   - 用語の定義(VP,V,IWR)
     車両を構成する個々の装備を装備オプションと呼ぶ．
     装備オプションはエンジンやタイヤなど，いくつかの種類に分類され，その種類を装備タイプと呼ぶ．
     各装備オプションに対し，IWRと呼ばれる重みが定まっている．

   - 車両装備仕様問題の入力(V,VP,IWR値,要求仕様,FE,SV,CAFE値,グレード)
     車両装備仕様問題の入力は，装備オプションと装備タイプの集合，グレードの数，CAFE基準値，依存関係のある
装備タイプや装備オプションの組み合わせからなる制約の集合である．
     出力は，各グレードの仕様となる装備オプションの組合せである．
     形式的には，以下が車両装備仕様問題に対する入力として与えられる．

     V: 装備オプションの集合．各要素は，装備オプション名，属する装備タイプ名，IWR値の組からなる．
     VP： 装備タイプの集合．各要素は装備タイプ名を示す．
     G: グレードの数は，何パターンのグレードの仕様を求めるかを示す値である
     t: CAFE基準値は全体の平均燃費の基準となる値である．
     ??: 要求仕様は，必須である装備タイプの集合，依存関係のある装備タイプと装備オプションや装備オプション同士の組の集合．
     FE: 
     SV: 

     車両装備仕様問題の出力は，グレードとそのグレードが装備する装備オプションの組合せの集合，各グレードの予想販売台数，
各グレードの燃費，全体の平均燃費からなる．

   - 車両装備仕様問題の制約
     車両装備仕様問題はこれらの入力に対し，以下の制約を満たす販売台数が最大となる解を求める問題である．
     + 個数制約
       各装備タイプをグレードごとに装備するか否か選択し，その装備タイプに属する装備オプションからちょうど1つを選択する
     + 燃費制約
       CAFE規制を基にした燃費制約が課される．
       グレードごとにIWR値の和を求める．
       テーブルとして与えられている，IWRと車両の燃費の関係，IWRと予想販売台数の関係を基に，
グレードごとの燃費と予想販売台数を求める．
       全体での平均燃費がCAFE基準値以上になるようにする．
       (燃費制約の式)

     + 要求仕様制約
       入力で与えられた要求仕様はすべて満たさなければならない．
       1.必須である装備タイプは必ず選択される
       2.特定の装備タイプが選択されたとき，それによって必須となる装備オプションがある
       3.特定の装備オプションが選択されたとき，それによって必須となる装備タイプがある
       4.特定の装備オプションが選択されたとき，それによって必須となる装備オプションがある
       
   - 可変性モデルを用いた車両装備仕様問題の記述例(例用のインスタンスを作る)
     - 例を決める
     - 解がCAFE値を上下すると良い

   - 例の最適解を示す
     
** 解集合プログラミング
   - 説明が必要なASPの機能
     + 選択子
     + 個数制約
     + #sum, #maximize
     + 一貫性制約
     + ファクト
     + #const
   - 重み付き個数制約である．アトムには重みをつけることができ，S = #sum {w_1,a_1;...;w_n,a_n} と書くと，
     「アトム集合{a_1;...;a_n}の任意の部分集合が成り立ち，」

** 車両装備仕様問題のASP符号化
   本節では，車両装備仕様問題の各種制約を論理プログラムとして表現する方法について述べる．
   車両装備仕様問題の入力はASPのファクトで表される，ファクトで表現したものを図に示す．
   タイプをvp_defで，オプションをv_defで表す．
   例えば，6行目のv_def("2WD","Drive\_Type",125)はオプションの2WDを表すファクトで，
   属するタイプはDrive\_Typeで，IWR値は125であることを示す．
   
   必須であるタイプを，37-41行目のrequire\_vpで示す．

   オプションによるオプションの要求を，44-47行目のrequire\_v\_vで示す．
   例えば，44行目のrequire\_v\_v("STD","16\_inch\_Tire")は，オプションSTDが装備される場合，
   オプション16\_inch\_Tireも装備しなければならないことを示す．

   53-55行目では車両装備仕様を示すためのグループ(group)を定義している．この例では3種類の車両装備仕様を想定しているため，
   groupは3つである．また，56-58行目の一貫性制約でそれぞれのグループがGradeのSTD, DX, LXに対応するようにする．
   


   最後に目的関数について述べる，車両装備仕様問題の目的は，制約をすべて満たし，各グループの
   販売台数の和が最大の解を求めることである．
   これは，XX行目の最大化関数(#maximize)を使うことで実現される．

   このプログラムの燃費制約に改良を加える．sum\_of\_iwrの求める範囲を縮小することで探索空間を小さくする．



   前述のプログラムの燃費制約におけるsumは，オプション個数制約や要求制約を考慮せず，
   すべてのオプションの組合せによるIWRの和を求めているため，無駄な探索空間を広げている．
   そこで，コードXXに表すようにプログラムを改良した．変更点としてはXX〜XX行目である．
   必須タイプの中で最もIWR値の小さいオプションのみで構成された装備仕様のIWR値の和を最小値，
   すべてのタイプの中で最もIWR値の大きいオプションをすべて装備して構成された装備仕様のIWR値の和を最大値として，
   IWR値の組合せの範囲を制限した．

** 性能評価
   - 実験内容
   - インスタンスの説明
   - 実験結果
     - 比較
       + smallでの各符号化のCPU時間
       + 目的関数の値と制約の関係
   - 考察

   ASPシステムにはclingo-5.4.0を使用した．
   問題1問あたりの時間制限は2時間とした．
   実行環境はmacマシン，Mac mini XXGHz, 64GB メモリである．
** 結論

** 参考文献


** メモ
   - 基礎化の説明，DLVやWASPも含まれる？
   - 考察，ConstraintsよりもRulesを比較したほうがいいのでは？
   - encode01.lpの18行目の説明
   - FEとSVのテーブルの説明どこでする？
     IWR値とFE,SVの関係を表すグラフをIWR値の取りうる値を範囲としてテーブルに変換し，
     
     ファクトを図として示すならどこまで載せる？本文に書く？
     テーブルの範囲の説明
   - sumの組み合わせの説明
   - SVの5刻みの説明
   - 装備仕様？車両装備仕様？
   - 車のデザインは複雑化し，更新サイクルは高速化している．よってASPで

   - iwr
     small & 2,820 & 576
     medium & 7,545 & 1,758
     big & 62,745 & 1,488

   - fe
     small & 1020 & 576
     medium & 2550 & 1758
     big & 2550 & 1488

   - sv
     small & 1050 & 576
     medium & 2625 & 1758
     big & 2625 & 1488
